(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{7276:(o,e,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4444)}])},4444:(o,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>p});var r=n(4848);let t={aws_project_region:"ap-northeast-1",aws_cognito_region:"ap-northeast-1",aws_user_pools_id:"ap-northeast-1_h2Ira36fY",aws_user_pools_web_client_id:"128mcrh4ftsd1onp7q9vomaolp",oauth:{}};var s=n(2589),l=n(9384),i=n(8768),a=n(6540);s.E.configure({...t,ssr:!0});let c=()=>(0,r.jsx)("h2",{children:"管理者画面"}),u=()=>(0,r.jsx)("h2",{children:"開発者画面"}),d=()=>(0,r.jsx)("h2",{children:"一般ユーザー画面"});async function g(){let o="https://ap-northeast-1h2ira36fy.auth.ap-northeast-1.amazoncognito.com/login?client_id=128mcrh4ftsd1onp7q9vomaolp&response_type=token&scope=openid+profile+email&redirect_uri=https://d1xj20n18wdq9y.cloudfront.net";console.log("\uD83D\uDD04 Redirecting manually to Cognito:",o),window.location.href=o}function h(){let[o,e]=(0,a.useState)(null),[n,t]=(0,a.useState)(!0),[s,h]=(0,a.useState)(!1);async function p(){try{console.log("\uD83D\uDD0D Fetching user info...");let r=new URLSearchParams(window.location.hash.substring(1)).get("id_token");if(r)console.log("✅ ID Token from URL:",r),window.history.replaceState({},document.title,"/");else try{var o,n;console.log("\uD83D\uDD0D Checking getCurrentUser()...");let e=await (0,l.H)();r=null==e?void 0:null===(n=e.signInUserSession)||void 0===n?void 0:null===(o=n.idToken)||void 0===o?void 0:o.jwtToken,console.log("✅ ID Token from getCurrentUser():",r)}catch(o){console.warn("⚠️ No authenticated user found. Redirecting to Cognito..."),h(!0),g();return}if(!r){console.warn("❌ No ID Token found. Redirecting to Cognito..."),h(!0),g();return}let t=function(o){try{let e=o.split(".");if(3!==e.length)throw Error("Invalid ID Token format");return JSON.parse(atob(e[1]))}catch(o){return console.error("❌ Failed to parse ID Token:",o),null}}(r);if(!t)throw Error("❌ Failed to parse ID token payload");console.log("✅ User Token Payload:",t);let s=t["cognito:groups"]||[];console.log("✅ User Groups:",s),e({username:t["cognito:username"],groups:s})}catch(o){console.error("❌ Error fetching user:",o),h(!0),g()}finally{t(!1)}}async function f(){try{await (0,i.C)(),console.log("✅ User signed out successfully."),window.location.href="/"}catch(o){console.error("❌ Sign out failed:",o)}}return(0,a.useEffect)(()=>{p()},[]),(0,r.jsx)("div",{style:{textAlign:"center",marginTop:"50px"},children:n||s?(0,r.jsx)("h2",{children:"\uD83D\uDD04 読み込み中..."}):o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("h1",{children:["ようこそ, ",o.username," さん"]}),(console.log("\uD83D\uDFE1 Checking user groups for dashboard rendering:",null==o?void 0:o.groups),o)?o.groups.includes("Proto-Admin-Group")?(0,r.jsx)(c,{}):o.groups.includes("Proto-Dev-Group")?(0,r.jsx)(u,{}):o.groups.includes("Proto-User-Group")?(0,r.jsx)(d,{}):(console.log("\uD83D\uDEAB No matching groups found:",o.groups),null):(console.log("\uD83D\uDEAB userInfo is null"),null),(0,r.jsx)("button",{onClick:f,style:{margin:"10px",padding:"10px",backgroundColor:"red",color:"white",border:"none",borderRadius:"5px"},children:"サインアウト"})]}):null})}function p(){return(0,r.jsx)(h,{})}s.E.configure(t)}},o=>{var e=e=>o(o.s=e);o.O(0,[95,636,593,792],()=>e(7276)),_N_E=o.O()}]);